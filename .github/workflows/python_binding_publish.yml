name: Build python binding wheels

on:
  push:
    branches:
      - master
  pull_request:
    branches:
      - dev
    paths-ignore:
      - 'specs/**'

jobs:

  linux-wheels:
    runs-on: ubuntu-latest
    container: quay.io/pypa/manylinux1_x86_64
    strategy:
      matrix:
        python-version: [3.5, 3.6, 3.7, 3.8]
    steps:
     - uses: actions/checkout@v1
     - uses: actions-rs/toolchain@v1
       with:
         toolchain: nightly
         default: true
     - uses: actions/setup-python@v2
       with:
         python-version: ${{ matrix.python-version }}
     - name: Build wheels
       working-directory: bindings/python/native
       run: |
         python3 -m pip install maturin
         maturin build --release
     - uses: actions/upload-artifact@v1
       with:
         name: linux-${{ matrix.python-version }}-wheel
         path: target/wheels

  # osx-wheels:
  #   runs-on: macos-latest
  #   strategy:
  #     matrix:
  #       python-version: [3.5, 3.6, 3.7, 3.8]
  #   steps:
  #    - uses: actions/checkout@v1
  #    - uses: actions-rs/toolchain@v1
  #      with:
  #        toolchain: nightly
  #        default: true
  #    - uses: actions/setup-python@v2
  #      with:
  #        python-version: ${{ matrix.python-version }}
  #    - name: Build wheels
  #      working-directory: bindings/python/native
  #      run: |
  #        python3 -m pip install maturin
  #        maturin build --release
  #    - uses: actions/upload-artifact@v1
  #      with:
  #        name: osx-${{ matrix.python-version }}-wheel
  #        path: target/wheels

  # windows-wheels:
  #   runs-on: windows-latest
  #   steps:
  #    - uses: actions/checkout@v1
  #    - uses: actions-rs/toolchain@v1
  #      with:
  #        toolchain: nightly
  #        default: true
  #    - uses: actions/setup-python@v2
  #    - name: Build wheels
  #      working-directory: bindings/python/native
  #      run: |
  #        python -m pip install maturin
  #        maturin build --release
  #    - uses: actions/upload-artifact@v1
  #      with:
  #        name: windows-wheels
  #        path: target/wheels
